<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ModernOS</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
            background: url('https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?w=1920&q=80') center/cover no-repeat;
            background-attachment: fixed;
        }

        .desktop {
            width: 100%;
            height: calc(100% - 60px);
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, 100px);
            grid-template-rows: repeat(auto-fill, 100px);
            gap: 20px;
            align-content: start;
        }

        .desktop-icon {
            width: 100px;
            height: 100px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .desktop-icon:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .desktop-icon svg {
            width: 48px;
            height: 48px;
            margin-bottom: 8px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }

        .desktop-icon span {
            color: white;
            font-size: 12px;
            text-align: center;
            text-shadow: 0 1px 3px rgba(0,0,0,0.8);
            font-weight: 500;
        }

        .taskbar {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            background: rgba(30, 30, 30, 0.8);
            backdrop-filter: blur(20px);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            padding: 0 15px;
            z-index: 10000;
        }

        .start-button {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        .start-button:hover {
            transform: scale(1.05);
        }

        .start-button svg {
            width: 24px;
            height: 24px;
        }

        .taskbar-apps {
            display: flex;
            gap: 8px;
            margin-left: 15px;
            flex: 1;
        }

        .taskbar-app {
            height: 48px;
            padding: 0 16px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            border-radius: 8px;
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.2s;
            font-size: 14px;
        }

        .taskbar-app:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .taskbar-app.active {
            background: rgba(255, 255, 255, 0.2);
        }

        .taskbar-clock {
            color: white;
            font-size: 14px;
            font-weight: 500;
            margin-left: auto;
            text-align: right;
        }

        .taskbar-clock .time {
            font-size: 16px;
        }

        .taskbar-clock .date {
            font-size: 11px;
            opacity: 0.8;
        }

        .window {
            position: absolute;
            min-width: 400px;
            min-height: 300px;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .window.minimized {
            display: none;
        }

        .window.maximized {
            top: 0 !important;
            left: 0 !important;
            width: 100% !important;
            height: calc(100% - 60px) !important;
            border-radius: 0;
        }

        .window-header {
            height: 40px;
            background: rgba(240, 240, 245, 0.9);
            backdrop-filter: blur(10px);
            display: flex;
            align-items: center;
            padding: 0 15px;
            cursor: move;
            user-select: none;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }

        .window-title {
            flex: 1;
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .window-controls {
            display: flex;
            gap: 8px;
        }

        .window-control {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: filter 0.2s;
        }

        .window-control:hover {
            filter: brightness(0.9);
        }

        .window-control.close {
            background: #ff5f57;
        }

        .window-control.minimize {
            background: #ffbd2e;
        }

        .window-control.maximize {
            background: #28ca42;
        }

        .window-content {
            flex: 1;
            overflow: auto;
            background: white;
        }

        .notepad-content {
            width: 100%;
            height: 100%;
            border: none;
            padding: 20px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: none;
            outline: none;
        }

        .calculator {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            padding: 20px;
            background: #f5f5f7;
            height: 100%;
        }

        .calc-display {
            grid-column: 1 / -1;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            text-align: right;
            font-size: 32px;
            font-weight: 300;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
        }

        .calc-button {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 500;
        }

        .calc-button:hover {
            background: #f0f0f0;
            transform: scale(1.02);
        }

        .calc-button:active {
            transform: scale(0.98);
        }

        .calc-button.operator {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
        }

        .calc-button.equals {
            grid-column: 3 / -1;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
        }

        .file-explorer {
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 20px;
            background: #fafafa;
            height: 100%;
            overflow: auto;
        }

        .folder {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .folder:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .folder svg {
            width: 64px;
            height: 64px;
            margin-bottom: 10px;
        }

        .folder span {
            font-size: 13px;
            text-align: center;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="desktop" id="desktop">
        <div class="desktop-icon" data-app="notepad">
            <svg fill="#4a90e2" viewBox="0 0 24 24"><path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20M10,19L12,15H9V10H13V15L11,19H10Z"/></svg>
            <span>Notepad</span>
        </div>
        <div class="desktop-icon" data-app="calculator">
            <svg fill="#e74c3c" viewBox="0 0 24 24"><path d="M7,2H17A2,2 0 0,1 19,4V20A2,2 0 0,1 17,22H7A2,2 0 0,1 5,20V4A2,2 0 0,1 7,2M7,4V8H17V4H7M7,10V12H9V10H7M11,10V12H13V10H11M15,10V12H17V10H15M7,14V16H9V14H7M11,14V16H13V14H11M15,14V16H17V14H15M7,18V20H9V18H7M11,18V20H13V18H11M15,18V20H17V18H15Z"/></svg>
            <span>Calcolatrice</span>
        </div>
        <div class="desktop-icon" data-app="explorer">
            <svg fill="#f39c12" viewBox="0 0 24 24"><path d="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"/></svg>
            <span>File Explorer</span>
        </div>
    </div>

    <div class="taskbar">
        <button class="start-button">
            <svg fill="white" viewBox="0 0 24 24"><path d="M3,3H11V11H3V3M13,3H21V11H13V3M3,13H11V21H3V13M13,13H21V21H13V13Z"/></svg>
        </button>
        <div class="taskbar-apps" id="taskbarApps"></div>
        <div class="taskbar-clock" id="clock">
            <div class="time">00:00</div>
            <div class="date">01/01/2025</div>
        </div>
    </div>

    <script>
        let zIndexCounter = 1000;
        const windows = {};
        
        function updateClock() {
            const now = new Date();
            const timeStr = now.toLocaleTimeString('it-IT', { hour: '2-digit', minute: '2-digit' });
            const dateStr = now.toLocaleDateString('it-IT', { day: '2-digit', month: '2-digit', year: 'numeric' });
            document.querySelector('.time').textContent = timeStr;
            document.querySelector('.date').textContent = dateStr;
        }
        
        setInterval(updateClock, 1000);
        updateClock();

        function createWindow(appName, title, content) {
            if (windows[appName] && document.body.contains(windows[appName])) {
                focusWindow(windows[appName]);
                if (windows[appName].classList.contains('minimized')) {
                    toggleMinimize(windows[appName]);
                }
                return;
            }

            const win = document.createElement('div');
            win.className = 'window';
            win.style.top = '100px';
            win.style.left = '200px';
            win.style.width = appName === 'calculator' ? '400px' : '600px';
            win.style.height = appName === 'calculator' ? '500px' : '500px';
            win.style.zIndex = ++zIndexCounter;
            
            win.innerHTML = `
                <div class="window-header">
                    <div class="window-title">${title}</div>
                    <div class="window-controls">
                        <button class="window-control close"></button>
                        <button class="window-control minimize"></button>
                        <button class="window-control maximize"></button>
                    </div>
                </div>
                <div class="window-content">${content}</div>
            `;
            
            document.body.appendChild(win);
            windows[appName] = win;
            
            makeDraggable(win);
            
            win.querySelector('.close').onclick = () => closeWindow(win, appName);
            win.querySelector('.minimize').onclick = () => toggleMinimize(win);
            win.querySelector('.maximize').onclick = () => toggleMaximize(win);
            
            win.onclick = () => focusWindow(win);
            
            addTaskbarApp(appName, title);
            
            if (appName === 'calculator') {
                initCalculator(win);
            }
        }

        function focusWindow(win) {
            win.style.zIndex = ++zIndexCounter;
        }

        function closeWindow(win, appName) {
            win.remove();
            delete windows[appName];
            removeTaskbarApp(appName);
        }

        function toggleMinimize(win) {
            win.classList.toggle('minimized');
        }

        function toggleMaximize(win) {
            win.classList.toggle('maximized');
        }

        function addTaskbarApp(appName, title) {
            const taskbarApps = document.getElementById('taskbarApps');
            const app = document.createElement('button');
            app.className = 'taskbar-app';
            app.dataset.app = appName;
            app.textContent = title;
            app.onclick = () => {
                const win = windows[appName];
                if (win.classList.contains('minimized')) {
                    toggleMinimize(win);
                }
                focusWindow(win);
            };
            taskbarApps.appendChild(app);
        }

        function removeTaskbarApp(appName) {
            const app = document.querySelector(`.taskbar-app[data-app="${appName}"]`);
            if (app) app.remove();
        }

        function makeDraggable(win) {
            const header = win.querySelector('.window-header');
            let isDragging = false;
            let currentX, currentY, initialX, initialY;

            header.addEventListener('mousedown', dragStart);

            function dragStart(e) {
                if (e.target.classList.contains('window-control')) return;
                if (win.classList.contains('maximized')) return;
                
                initialX = e.clientX - win.offsetLeft;
                initialY = e.clientY - win.offsetTop;
                isDragging = true;
                
                document.addEventListener('mousemove', drag);
                document.addEventListener('mouseup', dragEnd);
            }

            function drag(e) {
                if (!isDragging) return;
                e.preventDefault();
                currentX = e.clientX - initialX;
                currentY = e.clientY - initialY;
                win.style.left = currentX + 'px';
                win.style.top = currentY + 'px';
            }

            function dragEnd() {
                isDragging = false;
                document.removeEventListener('mousemove', drag);
                document.removeEventListener('mouseup', dragEnd);
            }
        }

        function initCalculator(win) {
            let display = win.querySelector('.calc-display');
            let currentValue = '0';
            let previousValue = null;
            let operation = null;

            function updateDisplay() {
                display.textContent = currentValue;
            }

            win.querySelectorAll('.calc-button').forEach(btn => {
                btn.onclick = () => {
                    const value = btn.dataset.value;
                    
                    if (value >= '0' && value <= '9') {
                        currentValue = currentValue === '0' ? value : currentValue + value;
                    } else if (value === '.') {
                        if (!currentValue.includes('.')) {
                            currentValue += '.';
                        }
                    } else if (value === 'C') {
                        currentValue = '0';
                        previousValue = null;
                        operation = null;
                    } else if (['+', '-', '*', '/'].includes(value)) {
                        if (previousValue !== null && operation) {
                            calculate();
                        }
                        previousValue = currentValue;
                        operation = value;
                        currentValue = '0';
                    } else if (value === '=') {
                        calculate();
                    }
                    
                    updateDisplay();
                };
            });

            function calculate() {
                if (previousValue === null || operation === null) return;
                
                const prev = parseFloat(previousValue);
                const curr = parseFloat(currentValue);
                let result;
                
                switch (operation) {
                    case '+': result = prev + curr; break;
                    case '-': result = prev - curr; break;
                    case '*': result = prev * curr; break;
                    case '/': result = prev / curr; break;
                }
                
                currentValue = String(result);
                previousValue = null;
                operation = null;
            }
        }

        document.querySelectorAll('.desktop-icon').forEach(icon => {
            icon.onclick = () => {
                const app = icon.dataset.app;
                
                if (app === 'notepad') {
                    createWindow('notepad', 'Notepad', '<textarea class="notepad-content" placeholder="Inizia a scrivere..."></textarea>');
                } else if (app === 'calculator') {
                    const calcContent = `
                        <div class="calculator">
                            <div class="calc-display">0</div>
                            <button class="calc-button" data-value="7">7</button>
                            <button class="calc-button" data-value="8">8</button>
                            <button class="calc-button" data-value="9">9</button>
                            <button class="calc-button operator" data-value="/">÷</button>
                            <button class="calc-button" data-value="4">4</button>
                            <button class="calc-button" data-value="5">5</button>
                            <button class="calc-button" data-value="6">6</button>
                            <button class="calc-button operator" data-value="*">×</button>
                            <button class="calc-button" data-value="1">1</button>
                            <button class="calc-button" data-value="2">2</button>
                            <button class="calc-button" data-value="3">3</button>
                            <button class="calc-button operator" data-value="-">−</button>
                            <button class="calc-button" data-value="0">0</button>
                            <button class="calc-button" data-value=".">.</button>
                            <button class="calc-button" data-value="C">C</button>
                            <button class="calc-button operator" data-value="+">+</button>
                            <button class="calc-button equals" data-value="=">=</button>
                        </div>
                    `;
                    createWindow('calculator', 'Calcolatrice', calcContent);
                } else if (app === 'explorer') {
                    const folders = ['Documenti', 'Immagini', 'Video', 'Musica', 'Download', 'Desktop'];
                    const explorerContent = `
                        <div class="file-explorer">
                            ${folders.map(folder => `
                                <div class="folder">
                                    <svg fill="#f39c12" viewBox="0 0 24 24"><path d="M10,4H4C2.89,4 2,4.89 2,6V18A2,2 0 0,0 4,20H20A2,2 0 0,0 22,18V8C22,6.89 21.1,6 20,6H12L10,4Z"/></svg>
                                    <span>${folder}</span>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    createWindow('explorer', 'File Explorer', explorerContent);
                }
            };
        });
    </script>
</body>
</html>